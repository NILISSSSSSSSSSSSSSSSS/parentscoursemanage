(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6aed8778"],{2899:function(e,t,i){},4979:function(e,t,i){},6488:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"all-user"},[i("el-form",{attrs:{inline:"","label-position":"right","label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"角色名称："}},[i("el-input",{attrs:{placeholder:"角色名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchList(t)}},model:{value:e.name,callback:function(t){e.name="string"===typeof t?t.trim():t},expression:"name"}})],1),i("el-button",{staticClass:"ml40 mb20",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchList}},[e._v("查询")]),i("el-button",{staticClass:"ml40 mb20",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.showEdit(0)}}},[e._v("添加角色")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mb20",attrs:{data:e.list,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"name",label:"角色名称"}}),i("el-table-column",{attrs:{prop:"remark",label:"角色描述"}}),i("el-table-column",{attrs:{prop:"id",label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{icon:"el-icon-edit",type:"success",size:"small"},on:{click:function(i){return e.showEdit(1,t.row)}}},[e._v("编辑")]),i("el-button",{attrs:{icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(i){return e.deleteRole(t.row)}}},[e._v("删除")])]}}])})],1),i("editRoles",{attrs:{editData:e.editData},on:{closeMain:e.closeMain,freshParent:e.searchList}}),i("pagination",{attrs:{currentPage:e.page.page,pageSize:e.page.limit,total:e.page.total},on:{change:e.changePage}})],1)},a=[],n=(i("cc57"),i("3191")),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{visible:e.editData.isShow,title:e.editData.isEdit?"编辑角色":"新增角色",width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.editData,"isShow",t)}}},[i("el-form",{ref:"editForm",attrs:{inline:"",model:e.editForm,rules:e.rules,labelPosition:"right",labelWidth:"100px"}},[i("el-form-item",{attrs:{prop:"name",label:"角色名称："}},[i("el-input",{attrs:{placeholder:"角色名称",clearable:""},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name","string"===typeof t?t.trim():t)},expression:"editForm.name"}})],1),i("el-form-item",{attrs:{label:"角色描述：",prop:"remark"}},[i("el-input",{attrs:{placeholder:"角色描述",clearable:""},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark","string"===typeof t?t.trim():t)},expression:"editForm.remark"}})],1),i("el-row",[i("el-form-item",{attrs:{label:"操作权限：",prop:"permissions"}},[i("menuTag",{staticClass:"mt5",model:{value:e.editForm.permissions,callback:function(t){e.$set(e.editForm,"permissions",t)},expression:"editForm.permissions"}})],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.close}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveRoles}},[e._v("确 定")])],1)],1)],1)},o=[],l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-tree",{ref:"tree",attrs:{data:e.menuList,"show-checkbox":"","node-key":"uuid","highlight-current":"",props:e.defaultProps},on:{"check-change":e.getChecked}})],1)},c=[],u={props:{value:{type:Array,default:function(){return[]}},checked:{type:Array,default:function(){return[]}}},data:function(){return{menuList:[],checkedList:[],defaultProps:{children:"subMenu",label:"menuName"}}},methods:{getMenuList:function(){var e=this;Object(n["mb"])().then((function(t){200===t.code&&(e.menuList=t.data)})).catch((function(e){console.log(e)}))},getChecked:function(e,t,i){var s=this.$refs.tree.getCheckedKeys();this.$emit("input",s)}},mounted:function(){this.getMenuList(),this.$refs.tree.setCheckedKeys(this.value)},watch:{value:function(e,t){this.$refs.tree.setCheckedKeys(e)},deep:!0}},d=u,m=(i("fa1e"),i("5511")),h=Object(m["a"])(d,l,c,!1,null,"133d62da",null),f=h.exports,p={props:{editData:{type:Object,default:function(){return{}}}},components:{menuTag:f},data:function(){return{editForm:{name:"",remark:"",permissions:[]},rules:{name:[{required:!0,message:"请输入名称",trigger:"change"}],remark:[{required:!0,message:"请输入角色描述",trigger:"change"}],permissions:[{required:!0,message:"请选择操作权限",trigger:"change"}]}}},methods:{saveRoles:function(){var e=this;this.$refs["editForm"].validate((function(t){if(!t)return!1;0!=e.editForm.permissions.length?e.editData.isEdit?e.edit():e.add():e.$message.error("请选择操作权限")}))},add:function(){var e=this;Object(n["f"])(this.editForm).then((function(t){200===t.code&&(e.$message.success(t.msg||"创建角色成功"),e.close(),e.$emit("freshParent"))}))},edit:function(){var e=this;Object(n["bb"])(this.editForm).then((function(t){200===t.code&&(e.$message.success(t.msg||"编辑角色成功"),e.close(),e.$emit("freshParent"))}))},close:function(){this.$emit("closeMain",!0)}},mounted:function(){},watch:{"editData.isShow":function(e,t){if(e)if(this.$refs["editForm"]&&this.$refs["editForm"].resetFields(),this.editData.isEdit){this.editForm=this.editData.data;var i=_.map(this.editForm.permissions,"uuid");this.editForm.permissions=i}else this.editForm={name:"",remark:"",permissions:[]}}}},g=p,b=(i("d064"),Object(m["a"])(g,r,o,!1,null,"6c4705a0",null)),v=b.exports,k={components:{editRoles:v},data:function(){return{roleList:[],name:"",roleId:"",list:[],editData:{isShow:!1,isEdit:!1,data:{}},page:{page:1,limit:10,total:0},loading:!1}},methods:{searchList:function(){var e=this,t={name:this.name,page:this.page.page,pageSize:this.page.limit};this.loading=!0,Object(n["ob"])(t).then((function(t){e.loading=!1,200===t.code&&(e.list=t.data.results,e.page.total=t.data.count)})).catch((function(t){e.loading=!1}))},showEdit:function(e,t){this.editData.isShow=!0,this.editData={isShow:!0,isEdit:!!e,data:e?JSON.parse(JSON.stringify(t)):{}}},closeMain:function(e){this.editData.isShow=!1},deleteRole:function(e){var t=this;this.$confirm("确定删除角色【"+e.name+"】?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(n["ac"])({uuid:e.uuid}).then((function(e){200===e.code&&(t.$message.success(e.msg||"删除成功"),t.searchList())}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},changePage:function(e,t){this.page.limit=t,this.page.page=e,this.searchList()}},mounted:function(){this.searchList()}},y=k,w=(i("de47"),Object(m["a"])(y,s,a,!1,null,"000d9fe3",null));t["default"]=w.exports},d064:function(e,t,i){"use strict";var s=i("2899"),a=i.n(s);a.a},d698:function(e,t,i){},de47:function(e,t,i){"use strict";var s=i("4979"),a=i.n(s);a.a},fa1e:function(e,t,i){"use strict";var s=i("d698"),a=i.n(s);a.a}}]);
//# sourceMappingURL=chunk-6aed8778.407e3959.js.map