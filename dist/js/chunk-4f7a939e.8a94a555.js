(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f7a939e"],{"0491":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"all-user"},[a("div",{staticClass:"buttonRow mb10"},[a("el-button",{staticClass:"mr10",attrs:{icon:"el-icon-back",type:"primary",size:"small"},on:{click:function(t){return e.$router.push("/seriesLession")}}},[e._v("\n        返回系列课列表\n      ")]),a("el-button",{staticClass:"mb2",attrs:{icon:"el-icon-plus",type:"primary",size:"small"},on:{click:function(t){return e.showEdit(0,{})}}},[e._v("添加章节\n      ")])],1),a("el-form",{attrs:{inline:"","label-position":"right","label-width":"100px"}},[a("el-row",[a("el-form-item",{attrs:{label:"章节名称"}},[a("el-input",{attrs:{size:"small"},model:{value:e.searchParams.chapterName,callback:function(t){e.$set(e.searchParams,"chapterName",t)},expression:"searchParams.chapterName"}})],1),a("el-form-item",{attrs:{label:"章节排号"}},[a("el-input",{attrs:{size:"small"},model:{value:e.searchParams.serialNumber,callback:function(t){e.$set(e.searchParams,"serialNumber",t)},expression:"searchParams.serialNumber"}})],1),a("el-form-item",{attrs:{label:"开启状态"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.searchParams.status,callback:function(t){e.$set(e.searchParams,"status",t)},expression:"searchParams.status"}},e._l(e.stateList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"创建时间范围"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),a("el-form-item",{attrs:{label:"开课时间范围"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],1),a("el-button",{staticClass:"ml40 mt4 mb20",attrs:{icon:"el-icon-search",type:"primary",size:"small"},on:{click:e.searchList}},[e._v("查询\n        ")]),a("el-button",{staticClass:"ml40 mb20 mt4",attrs:{icon:"el-icon-setting",type:"primary",size:"small",plain:""},on:{click:e.resetParams}},[e._v("重置")])],1),a("el-row")],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mb20",attrs:{data:e.list,border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"serialNumber",label:"章节排号",width:"80px"}}),a("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("div",{staticClass:"tableAvaterBox"},[a("img",{staticClass:"tableAvater",attrs:{src:t.chapterBanner,alt:""}})])]}}])}),a("el-table-column",{attrs:{prop:"name",label:"章节名称"}}),a("el-table-column",{attrs:{label:"课程形式"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e._f("courseStyle")(a.chapterStyle))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"专家",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return a.expert?[e._v("\n          "+e._s(a.expert.name)+"\n        ")]:void 0}}],null,!0)}),a("el-table-column",{attrs:{label:"启用状态",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e._f("chapterStatus")(a.status))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e._f("formatDate")(a.createTime))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"课程开始时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e._f("formatDate")(a.startTime))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"课程时长",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e.$utils.TimestampToTime(a.duration))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"课程状态"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{class:2!==i.updateStatus?"col-sucs":"col-danger"},[e._v(e._s(e._f("updateStatus")(i.updateStatus)))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"340px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[0!=t.$index?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"向上",placement:"top"}},[a("el-button",{attrs:{icon:"el-icon-top",circle:""},on:{click:function(a){return e.changeWeight(t.row,"up")}}})],1):e._e(),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"向下",placement:"top"}},[a("el-button",{attrs:{icon:"el-icon-bottom",circle:""},on:{click:function(a){return e.changeWeight(t.row,"down")}}})],1),a("el-button",{staticClass:"mr10",attrs:{icon:"el-icon-edit",type:"primary",size:"small",loading:t.row.loading},on:{click:function(a){return e.showEdit(1,t.row)}}},[e._v("编辑\n          ")]),a("el-dropdown",{staticClass:"mr10",attrs:{size:"small","split-button":"",type:"warning"},on:{command:e.changeStatus}},[a("span",[e._v(e._s(e._f("chapterStatus")(t.row.status)))]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:t.row.uuid+",1",disabled:1==t.row.status}},[e._v("启用")]),a("el-dropdown-item",{attrs:{command:t.row.uuid+",2",disabled:2==t.row.status}},[e._v("停用")]),a("el-dropdown-item",{attrs:{command:t.row.uuid+",3",disabled:3==t.row.status}},[e._v("下架")]),a("el-dropdown-item",{attrs:{command:t.row.uuid+",4",disabled:4==t.row.status}},[e._v("删除")])],1)],1),1==t.row.chapterStyle?a("router-link",{staticClass:"el-button el-button--text el-button--small",attrs:{to:{path:"/liveRoom/",query:{uuid:t.row.uuid,type:"chapter"}}}},[e._v("进入直播间\n          ")]):e._e(),a("div",[t.row.courseSource?a("a",{staticClass:"aLink",staticStyle:{color:"#409EFF"},attrs:{href:t.row.courseSource.sourceUrl,target:"_blank"}},[a("span",{staticClass:"el-icon-download"}),e._v(" 下载授课内容\n            ")]):e._e(),a("el-button",{attrs:{icon:"el-icon-headset",loading:t.row.loading2,type:"text",size:"small"},on:{click:function(a){return e.freeListen(t.row)}}},[e._v("\n              "+e._s(t.row.isTry?"取消试听":"免费试听")+" ")])],1)]}}])})],1),a("pagination",{attrs:{currentPage:e.page.page,pageSize:e.page.limit,total:e.page.total},on:{change:e.changePage}})],1),a("add-chapter",{attrs:{menuObj:e.menuObj},on:{closeMain:e.closeMain,freshParent:function(t){return e.searchList()}}})],1)},s=[],r=(a("5ab2"),a("6d57"),a("e10e"),a("163d"),a("9a33e"),a("e204"),a("9d37")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.menuObj.isShow,title:e.menuObj.isEdit?"编辑章节":"新增章节",top:"20px","append-to-body":"",width:"800px"},on:{"update:visible":function(t){return e.$set(e.menuObj,"isShow",t)}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"136px"}},[a("el-form-item",{attrs:{label:"章节名称：",prop:"name",rules:e.notEmptyBlur}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"课程模式：",prop:"chapterStyle",rules:e.notEmptyChange}},[a("el-radio-group",{on:{change:function(t){e.form.courseSourceUuid=e.form.tryInfoUuid={}}},model:{value:e.form.chapterStyle,callback:function(t){e.$set(e.form,"chapterStyle",t)},expression:"form.chapterStyle"}},[a("el-radio",{attrs:{label:"3",disabled:e.menuObj.isEdit}},[e._v("视频课")]),a("el-radio",{attrs:{label:"2",disabled:e.menuObj.isEdit}},[e._v("音频课")]),a("el-radio",{attrs:{label:"1",disabled:e.menuObj.isEdit}},[e._v("直播课")])],1)],1),a("el-form-item",{attrs:{prop:"expertUuid",label:"主讲专家：",rules:e.notEmptyChange}},[a("el-select",{attrs:{"remote-method":e.getExpertList,placeholder:"请输入专家名称搜索",filterable:"",remote:"","reserve-keyword":"",size:"small",clearable:""},model:{value:e.form.expertUuid,callback:function(t){e.$set(e.form,"expertUuid",t)},expression:"form.expertUuid"}},e._l(e.expertList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.uuid}})})),1)],1),"1"==e.form.chapterStyle?[a("el-form-item",{attrs:{prop:"startTime",label:"直播时间：",rules:e.notEmptyChange}},[a("el-date-picker",{staticClass:"w200",attrs:{type:"datetime",size:"small",editable:!1,"picker-options":e.pickerOptions},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}})],1),a("el-form-item",{attrs:{prop:"mc",label:"主持人："}},[a("el-select",{attrs:{"remote-method":e.getAllUserMC,placeholder:"请输入用户名搜索",filterable:"",remote:"","reserve-keyword":"",size:"small",clearable:""},model:{value:e.form.mc,callback:function(t){e.$set(e.form,"mc",t)},expression:"form.mc"}},e._l(e.mcList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nickName,value:e.uuid}})})),1)],1),a("el-form-item",{attrs:{label:"嘉宾："}},[a("el-select",{attrs:{"remote-method":e.getAllUser,size:"small",placeholder:"请输入用户名搜索",multiple:"",filterable:"",remote:"","reserve-keyword":"",clearable:""},model:{value:e.form.inviter,callback:function(t){e.$set(e.form,"inviter",t)},expression:"form.inviter"}},e._l(e.inviterList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nickName,value:e.uuid}})})),1)],1)]:e._e(),a("add-courseware",{attrs:{mode:e.mode,labels:"上传课件："},model:{value:e.form.courseSourceUuid,callback:function(t){e.$set(e.form,"courseSourceUuid",t)},expression:"form.courseSourceUuid"}}),"1"!=e.form.chapterStyle?a("add-courseware",{attrs:{mode:e.mode,labels:"上传试听："},model:{value:e.form.tryInfoUuid,callback:function(t){e.$set(e.form,"tryInfoUuid",t)},expression:"form.tryInfoUuid"}}):e._e(),"1"==e.form.chapterStyle?[a("uploadLiveBanner",{model:{value:e.form.liveCourseBanner,callback:function(t){e.$set(e.form,"liveCourseBanner",t)},expression:"form.liveCourseBanner"}})]:e._e(),a("el-form-item",{attrs:{label:"上传封面图：",prop:"chapterBanner",rules:e.notEmptyChange}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"",accept:"image/png, image/jpeg","before-upload":e.beforeBgUpload}},[e.form.chapterBanner?a("img",{staticClass:"avatar",attrs:{src:e.form.chapterBanner}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("div",{staticClass:"tips"},[e._v("建议最佳尺寸"),a("span",{staticClass:"col-danger"},[e._v("111*111px")])])],1),a("el-form-item",{attrs:{label:"关键词设置："}},[e._l(e.form.keywords,(function(t){return a("el-tag",{key:t,staticClass:"mr10",attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.delKeyWorlds(t)}}},[e._v("\n        "+e._s(t)+"\n      ")])})),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 新增关键词")])],2),a("el-form-item",{attrs:{label:"启用状态：",rules:e.notEmptyChange,prop:"status"}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:"1"}},[e._v(" 启用")]),a("el-radio",{attrs:{label:"2"}},[e._v("停用")]),a("el-radio",{attrs:{label:"3"}},[e._v("下架")]),a("el-radio",{attrs:{label:"4"}},[e._v("删除")])],1)],1)],2),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"mr10",attrs:{type:"primary",loading:e.saveLoding},on:{click:function(t){return e.save("form")}}},[e._v("保存")]),a("el-button",{staticClass:"mr10",attrs:{type:"primary"},on:{click:e.closeDialog}},[e._v("取消")])],1)],1)},l=[],n=(a("ed63"),a("8cf2"),a("cc57"),a("3191")),u=a("57cc"),c=a("3811"),m={components:{addCourseware:u["a"],uploadLiveBanner:c["a"]},props:{menuObj:{type:Object,default:function(){return{}}}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},loadingAll:!1,saveLoding:!1,current:"",form:{liveCourseBanner:{},liveCourseUuid:"",chapterStyle:"3",chapterBanner:"",courseSourceUuid:{},tryInfoUuid:{},keywords:[]},mode:"video",expertList:[],mcList:[],inviterList:[],inputVisible:!1,inputValue:"",uploadLoading:!1,notEmptyBlur:[{required:!0,message:"不能为空",trigger:"blur"}],notEmptyChange:[{required:!0,message:"不能为空",trigger:"change"}],rules:{}}},created:function(){},methods:{getExpertList:function(e){var t=this;return new Promise((function(a,i){var s={name:e,page:1,pageSize:1e4,enable:!0};Object(n["jc"])(s).then((function(e){200===e.code?(t.expertList=e.data.results,a()):i()})).catch((function(e){i()}))}))},getAllUserMC:function(e){var t=this;return new Promise((function(a,i){var s={nickName:e,page:1,pageSize:1e4};Object(n["gb"])(s).then((function(e){200===e.code?(t.mcList=e.data.results,a()):i()})).catch((function(e){i()}))}))},getAllUser:function(e){var t=this;return new Promise((function(a,i){var s={nickName:e,page:1,pageSize:1e4};Object(n["gb"])(s).then((function(e){200===e.code?(t.inviterList=e.data.results,a()):i()})).catch((function(e){i()}))}))},closeDialog:function(){var e={isShowEdit:!1};this.$emit("closeMain",e)},resetForm:function(){this.form={liveCourseBanner:{},liveCourseUuid:"",chapterStyle:"3",chapterBanner:"",courseSourceUuid:{},tryInfoUuid:{},keywords:[]},this.mode="video"},save:function(e){var t=this;this.$refs["form"].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a=JSON.parse(JSON.stringify(t.form));if(t.form.expertUuid){if("1"==t.form.chapterStyle){if(!t.form.mc)return void t.$message.error("必须选择一个专家");a.liveCourseBanner=a.liveCourseBanner.name?a.liveCourseBanner:null,a.liveCourseUuid=a.courseSourceUuid.uuid||null,delete a.courseSourceUuid,delete a.tryInfoUuid}else a.courseSourceUuid=a.courseSourceUuid.uuid||null,a.tryInfoUuid=a.tryInfoUuid.uuid||null,delete a.liveCourseBanner,delete a.liveCourseUuid;if("1"!==t.form.chapterStyle){if(0==t.form.courseSourceUuid.length)return void t.$message.error("必须上传课件");t.form.mc=null}if(t.form.chapterBanner){a.startTime=a.startTime?t.$utils.formatDate(a.startTime,"yyyy-MM-dd hh:mm:ss"):null,a.courseUuid=t.$route.query.courseUuid;var i=[+a.chapterStyle,+a.status];a.chapterStyle=i[0],a.status=i[1],console.log("参数"+JSON.stringify(a));var s=null;t.menuObj.isEdit?(s=n["K"],a.uuid=t.form.uuid):s=n["F"],t.saveLoding=!0,s(a).then((function(e){t.saveLoding=!1,200===e.code&&(t.$message.success("成功"),t.$emit("freshParent"),t.closeDialog())})).catch((function(e){t.saveLoding=!1}))}else t.$message.error("必须上传封面")}else t.$message.error("必须选择一个主持人")}))},beforeBgUpload:function(e){var t=this;return e.type.includes("image")?(this.uploadLoading=!0,this.$uploadFile.checkedFileMD5ByFile(e,(function(e){e.url&&(t.$set(t.form,"chapterBanner",e.url),t.uploadLoading=!1)})),!1):(this.$message.error("请上传图片"),!1)},delKeyWorlds:function(e){this.form.keywords.splice(this.form.keywords.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this.inputValue;e&&this.form.keywords.push(e),this.inputVisible=!1,this.inputValue=""}},watch:{"menuObj.isShow":function(e,t){if(e)if(this.$refs["form"]&&this.$refs["form"].resetFields(),this.menuObj.isEdit){var a=JSON.parse(JSON.stringify(this.menuObj.data));this.form=JSON.parse(JSON.stringify(this.menuObj.data));var i=[this.form.chapterStyle+"",+this.form.status+""];if(this.form.chapterStyle=i[0],this.form.status=i[1],this.expertList=[a.experts],this.$set(this.form,"expertUuid",this.form.experts.uuid),"1"==this.form.chapterStyle){this.form.courseSourceUuid=a.liveCourseUuid,this.form.liveCourseBanner=a.liveCourseBanner?a.liveCourseBanner:{},this.mcList=[a.mc],this.inviterList=a.inviter;var s=[this.form.mc.uuid];this.form.mc=s[0],this.form.inviter=this.form.inviter.map((function(e){return e.uuid}))}}else this.resetForm(),this.expertList=this.mcList=this.inviterList=[]},"form.courseSourceUuid":function(e){e.bannerInfo&&"{}"!==JSON.stringify(e.bannerInfo)&&(console.log("赋值"),this.$set(this.form,"liveCourseBanner",e.bannerInfo))},"form.chapterStyle":function(e){"1"==e?this.mode="live":"2"==e?this.mode="audio":"3"==e&&(this.mode="video")}}},d=m,f=(a("fa84"),a("5511")),p=Object(f["a"])(d,o,l,!1,null,"42318d9b",null),h=p.exports;function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={components:{addChapter:h},computed:{},data:function(){return{loading:!1,addChapterDia:!1,searchParams:{},list:[],stateList:[{label:"全部",value:""},{label:"启用",value:"1"},{label:"停用",value:"2"},{label:"下架",value:"3"},{label:"删除",value:"4"}],createTime:[],startTime:[],page:{page:1,limit:10,total:0},detail:{},courseUuid:null,menuObj:{isShow:!1,isEdit:!1,data:{}}}},mounted:function(){this.courseUuid=this.$route.query.courseUuid,this.searchList()},watch:{},methods:{closeMain:function(e){this.menuObj.isShow=!1},changePage:function(e,t){this.page.limit=t,this.page.page=e,this.searchList()},searchList:function(){var e=this,t=this.createTime||[],a=this.startTime||[];t=this.$utils.formatRange(t),a=this.$utils.formatRange(a),this.searchParams.createTime_after=t[0],this.searchParams.createTime_before=t[1],this.searchParams.startTime_after=a[0],this.searchParams.startTime_before=a[1];var i=v({},this.searchParams,{courseUuid:this.courseUuid,page:this.page.page,pageSize:this.page.limit});this.loading=!0,Object(n["H"])(i).then((function(t){if(200===t.code)if(t.data&&t.data.count>0){var a=[t.data.results,t.data.count];e.list=a[0],e.page.total=a[1]}else{var i=[[],0];e.list=i[0],e.page.total=i[1]}e.loading=!1})).catch((function(t){e.loading=!1}))},changeWeight:function(e,t){var a=this,i=this.list.findIndex((function(t){return t.uuid==e.uuid})),s={uuid:e.uuid};if("up"==t){if(i-1<0)return void this.$message.error("已经是第一个了");s.objUuid=this.list[i-1].uuid}else{if(i+1>this.list.length-1)return void this.$message.error("已经是最后一个了");s.objUuid=this.list[i+1].uuid}Object(n["J"])(s).then((function(e){200===e.code&&(a.$message.success("成功"),a.searchList())}))},changeStatus:function(e){var t=this;e=e.split(",");var a={uuid:e[0],status:Number(e[1])};Object(n["E"])(a).then((function(e){200===e.code&&(t.$message.success(e.msg||"操作成功"),t.searchList())})).catch((function(e){t.$message.error(e.msg||"操作失败")}))},showEdit:function(e,t){var a=this,i=null;if(e){var s={uuid:t.uuid};this.$set(t,"loading",!0),Object(n["G"])(s).then((function(s){a.$set(t,"loading",!1),200===s.code&&(console.log("章节详情："+JSON.stringify(s.data)),i=s.data,a.menuObj={isShow:!0,isEdit:!!e,data:i})})).catch((function(e){a.$set(t,"loading",!1)}))}else this.menuObj={isShow:!0,isEdit:!!e,data:{}}},resetParams:function(){this.page.page=1,this.searchParams={},this.createTime=this.startTime=[],this.searchList()},freeListen:function(e){var t=this,a=e.isTry?"确定取消?":"免费后用户无需购买即可看到此章节全部内容，确定免费吗?";this.$confirm(a,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={uuid:e.uuid};t.$set(e,"loading2",!0),Object(n["I"])(a).then((function(a){200===a.code&&(t.$message.success("成功"),t.searchList()),t.$set(e,"loading2",!1)})).catch((function(a){t.$set(e,"loading2",!1)}))})).catch((function(){}))}}},y=g,w=(a("444e"),Object(f["a"])(y,i,s,!1,null,"9d5fd0be",null));t["default"]=w.exports},"271a":function(e,t,a){"use strict";var i=a("7721"),s=a.n(i);s.a},"38e4":function(e,t,a){},"444e":function(e,t,a){"use strict";var i=a("38e4"),s=a.n(i);s.a},"57cc":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:e.form,"label-width":e.labelWidth}},[a("el-form-item",{class:e.labels.includes("上传课件")?"formRedStar left40":"",attrs:{label:e.labels}},[a("el-tabs",{on:{"tab-click":function(t){e.$emit("input",{}),e.$emit("getUploadType",e.activeName)}},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"从课件库选择",name:"fromCourseware"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.chooseCourseware}},[e._v("点击上传")])],1),"live"!==e.mode?a("el-tab-pane",{attrs:{label:"直接上传",name:"direceUpload"}},[a("el-upload",{attrs:{action:"",limit:1,"on-exceed":e.handleExceed,"before-upload":e.beforeDocumentUpload,"on-remove":e.handleRemovecourseware}},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.loadingButton}},[e._v("点击上传")])],1)],1):e._e(),e.fileListClass&&e.fileListClass.name?a("div",{staticStyle:{"line-height":"1.7"}},[e._v("\n          上传结果: "+e._s(e.fileListClass.name)+" \n        ")]):e._e(),["live"==e.mode?a("div",{staticClass:"tips"},[e._v("可上传音频(mp3)、视频(mp4)、图片、文本(txt) ")]):e._e(),"video"==e.mode?a("div",{staticClass:"tips"},[e._v("可上传视频(mp4)")]):e._e(),"audio"==e.mode?a("div",{staticClass:"tips"},[e._v("可上传音频(mp3)")]):e._e()]],2)],1)],1),a("el-dialog",{attrs:{title:"选择课件",visible:e.dialogFormVisible,id:"chooseMask","append-to-body":"","before-close":e.close},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("lession-storeManageAll",{attrs:{componentObj:e.componentObj},on:{tellPar:e.tellPar}}),a("div",{staticClass:"tc mt20"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("确定")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.close}},[e._v("取消")])],1)],1)],1)},s=[],r=(a("163d"),a("ed63"),a("8cf2"),a("cc57"),a("c12b")),o=a("3191"),l={components:{lessionStoreManageAll:r["default"]},props:{labelWidth:{type:String,default:"130px"},labels:{type:String,default:"添加课件："},value:{type:Object,default:function(){return{}}},mode:{type:String,default:"video"},uploadType:{type:String,default:"fromCourseware"}},data:function(){return{activeName:this.uploadType,form:{},fileListClass:this.value,dialogFormVisible:!1,isSelect:!0,selectData:[],componentObj:{isSelect:!0,mode:this.mode,dialogFormVisible:this.dialogFormVisible},loadingButton:!1}},created:function(){},watch:{value:function(e){e&&(this.fileListClass=e)},mode:function(e){this.componentObj.mode=e},dialogFormVisible:function(e){this.componentObj.dialogFormVisible=e}},methods:{close:function(){this.dialogFormVisible=!1},save:function(){if(this.selectData.length>1)this.$message.error("最多只能选择一个");else if(this.selectData.length<1)this.$message.error("必须选择一个");else{this.dialogFormVisible=!1;var e=this.selectData[0].bannerInfo?this.selectData[0].bannerInfo:{};this.fileListClass={uuid:this.selectData[0].uuid,name:this.selectData[0].name,sourceUrl:this.selectData[0].sourceUrl,bannerInfo:e},this.$emit("input",this.fileListClass),this.dialogFormVisible=!1}},tellPar:function(e){this.selectData=e},chooseCourseware:function(){this.isSelect=!0,this.dialogFormVisible=!0},handleRemovecourseware:function(e,t){this.fileListClass={},this.$emit("input",this.fileListClass)},checkType:function(e){return"video"!=this.mode||e.includes("mp4")?!("audio"==this.mode&&!e.includes("mp3"))||(this.$message.error("请上传音频(MP3格式)的文件"),!1):(this.$message.error("请上传视频(MP4格式)的文件"),!1)},handleExceed:function(e,t){this.$message.warning("最多只能上传一个文件")},beforeDocumentUpload:function(e,t){var a=this;return console.log(e),this.checkType(e.type)&&(this.loadingButton=!0,this.$uploadFile.checkedFileMD5ByFile(e,(function(t){if(t.url){var i={audio:"2",video:"1"},s=a.$utils.getFileInfo(e),r={name:e.name,sourceUrl:t.url,fileSize:Number((e.size/1024).toFixed(0)),sourceType:i[s.sourceType]};a.$utils.getAudioDuration(t.url).then((function(e){r.duration=e,Object(o["Fb"])(r).then((function(e){a.loadingButton=!1,200===e.code&&(a.fileListClass={name:e.data.name,uuid:e.data.uuid,sourceUrl:e.data.sourceUrl},a.$emit("input",a.fileListClass))})).catch((function(e){a.loadingButton=!1}))}))}}))),!1}}},n=l,u=(a("271a"),a("5511")),c=Object(u["a"])(n,i,s,!1,null,"0fe2b5e7",null);t["a"]=c.exports},7721:function(e,t,a){},ab67:function(e,t,a){},fa84:function(e,t,a){"use strict";var i=a("ab67"),s=a.n(i);s.a}}]);
//# sourceMappingURL=chunk-4f7a939e.8a94a555.js.map